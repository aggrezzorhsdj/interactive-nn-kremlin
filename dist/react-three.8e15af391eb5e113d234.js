"use strict";(self.webpackChunkreact_threejs=self.webpackChunkreact_threejs||[]).push([[931],{3865:(e,t,n)=>{n.d(t,{a:()=>c});var r=n(8168),o=n(9437),a=n(6540),i=n(9689),s=n(1436);const c=(0,a.forwardRef)(((e,t)=>{(0,a.useMemo)((()=>{const e={Box3:o.Box3,MathUtils:{clamp:o.MathUtils.clamp},Matrix4:o.Matrix4,Quaternion:o.Quaternion,Raycaster:o.Raycaster,Sphere:o.Sphere,Spherical:o.Spherical,Vector2:o.Vector2,Vector3:o.Vector3,Vector4:o.Vector4};s.A.install({THREE:e}),(0,i.e)({CameraControlsImpl:s.A})}),[]);const{camera:n,domElement:c,makeDefault:l,onStart:u,onEnd:d,onChange:f,regress:p,...h}=e,m=(0,i.z)((e=>e.camera)),v=(0,i.z)((e=>e.gl)),g=(0,i.z)((e=>e.invalidate)),y=(0,i.z)((e=>e.events)),b=(0,i.z)((e=>e.setEvents)),w=(0,i.z)((e=>e.set)),E=(0,i.z)((e=>e.get)),S=(0,i.z)((e=>e.performance)),_=n||m,P=c||y.connected||v.domElement,x=(0,a.useMemo)((()=>new s.A(_)),[_]);return(0,i.A)(((e,t)=>{x.enabled&&x.update(t)}),-1),(0,a.useEffect)((()=>(x.connect(P),()=>{x.disconnect()})),[P,x]),(0,a.useEffect)((()=>{const e=e=>{g(),p&&S.regress(),f&&f(e)},t=e=>{u&&u(e)},n=e=>{d&&d(e)};return x.addEventListener("update",e),x.addEventListener("controlstart",t),x.addEventListener("controlend",n),x.addEventListener("control",e),x.addEventListener("transitionstart",e),x.addEventListener("wake",e),()=>{x.removeEventListener("update",e),x.removeEventListener("controlstart",t),x.removeEventListener("controlend",n),x.removeEventListener("control",e),x.removeEventListener("transitionstart",e),x.removeEventListener("wake",e)}}),[x,u,d,g,b,p,f]),(0,a.useEffect)((()=>{if(l){const e=E().controls;return w({controls:x}),()=>w({controls:e})}}),[l,x]),a.createElement("primitive",(0,r.A)({ref:t,object:x},h))}))},920:(e,t,n)=>{n.d(t,{p:()=>l});var r=n(8132),o=n(2908),a=n(1432),i=n(9689);let s=null;function c(e,t,n){return a=>{n&&n(a),e&&(s||(s=new r.Z),s.setDecoderPath("string"==typeof e?e:"https://www.gstatic.com/draco/versioned/decoders/1.5.5/"),a.setDRACOLoader(s)),t&&a.setMeshoptDecoder("function"==typeof o.f?(0,o.f)():o.f)}}function l(e,t=!0,n=!0,r){return(0,i.D)(a.B,e,c(t,n,r))}l.preload=(e,t=!0,n=!0,r)=>i.D.preload(a.B,e,c(t,n,r)),l.clear=e=>i.D.clear(a.B,e)},9174:(e,t,n)=>{n.d(t,{z:()=>s});var r=n(9437),o=n(9689),a=n(6540);const i=e=>e===Object(e)&&!Array.isArray(e)&&"function"!=typeof e;function s(e,t){const n=(0,o.z)((e=>e.gl)),s=(0,o.D)(r.TextureLoader,i(e)?Object.values(e):e);if((0,a.useLayoutEffect)((()=>{null==t||t(s)}),[t]),(0,a.useEffect)((()=>{(Array.isArray(s)?s:[s]).forEach(n.initTexture)}),[n,s]),i(e)){const t=Object.keys(e),n={};return t.forEach((e=>Object.assign(n,{[e]:s[t.indexOf(e)]}))),n}return s}s.preload=e=>o.D.preload(r.TextureLoader,e),s.clear=e=>o.D.clear(r.TextureLoader,e)},9644:(e,t,n)=>{n.d(t,{E:()=>v});var r=n(8168),o=n(6540),a=n(5338),i=n(9437),s=n(9689);const c=new i.Vector3,l=new i.Vector3,u=new i.Vector3;function d(e,t,n){const r=c.setFromMatrixPosition(e.matrixWorld);r.project(t);const o=n.width/2,a=n.height/2;return[r.x*o+o,-r.y*a+a]}const f=e=>Math.abs(e)<1e-10?0:e;function p(e,t,n=""){let r="matrix3d(";for(let n=0;16!==n;n++)r+=f(t[n]*e.elements[n])+(15!==n?",":")");return n+r}const h=(m=[1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1],e=>p(e,m));var m;const v=o.forwardRef((({children:e,eps:t=.001,style:n,className:m,prepend:v,center:g,fullscreen:y,portal:b,distanceFactor:w,sprite:E=!1,transform:S=!1,occlude:_,onOcclude:P,castShadow:x,receiveShadow:M,material:C,geometry:j,zIndexRange:A=[16777271,0],calculatePosition:O=d,as:R="div",wrapperClass:k,pointerEvents:z="auto",...T},L)=>{const{gl:D,camera:I,scene:F,size:H,raycaster:W,events:$,viewport:V}=(0,s.z)(),[B]=o.useState((()=>document.createElement(R))),q=o.useRef(),U=o.useRef(null),N=o.useRef(0),G=o.useRef([0,0]),X=o.useRef(null),Y=o.useRef(null),Q=(null==b?void 0:b.current)||$.connected||D.domElement.parentNode,Z=o.useRef(null),J=o.useRef(!1),K=o.useMemo((()=>_&&"blending"!==_||Array.isArray(_)&&_.length&&function(e){return e&&"object"==typeof e&&"current"in e}(_[0])),[_]);o.useLayoutEffect((()=>{const e=D.domElement;_&&"blending"===_?(e.style.zIndex=`${Math.floor(A[0]/2)}`,e.style.position="absolute",e.style.pointerEvents="none"):(e.style.zIndex=null,e.style.position=null,e.style.pointerEvents=null)}),[_]),o.useLayoutEffect((()=>{if(U.current){const e=q.current=a.H(B);if(F.updateMatrixWorld(),S)B.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const e=O(U.current,I,H);B.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${e[0]}px,${e[1]}px,0);transform-origin:0 0;`}return Q&&(v?Q.prepend(B):Q.appendChild(B)),()=>{Q&&Q.removeChild(B),e.unmount()}}}),[Q,S]),o.useLayoutEffect((()=>{k&&(B.className=k)}),[k]);const ee=o.useMemo((()=>S?{position:"absolute",top:0,left:0,width:H.width,height:H.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:g?"translate3d(-50%,-50%,0)":"none",...y&&{top:-H.height/2,left:-H.width/2,width:H.width,height:H.height},...n}),[n,g,y,H,S]),te=o.useMemo((()=>({position:"absolute",pointerEvents:z})),[z]);o.useLayoutEffect((()=>{var t,r;J.current=!1,S?null==(t=q.current)||t.render(o.createElement("div",{ref:X,style:ee},o.createElement("div",{ref:Y,style:te},o.createElement("div",{ref:L,className:m,style:n,children:e})))):null==(r=q.current)||r.render(o.createElement("div",{ref:L,style:ee,className:m,children:e}))}));const ne=o.useRef(!0);(0,s.A)((e=>{if(U.current){I.updateMatrixWorld(),U.current.updateWorldMatrix(!0,!1);const e=S?G.current:O(U.current,I,H);if(S||Math.abs(N.current-I.zoom)>t||Math.abs(G.current[0]-e[0])>t||Math.abs(G.current[1]-e[1])>t){const t=function(e,t){const n=c.setFromMatrixPosition(e.matrixWorld),r=l.setFromMatrixPosition(t.matrixWorld),o=n.sub(r),a=t.getWorldDirection(u);return o.angleTo(a)>Math.PI/2}(U.current,I);let n=!1;K&&("blending"!==_?n=[F]:Array.isArray(_)&&(n=_.map((e=>e.current))));const r=ne.current;if(n){const e=function(e,t,n,r){const o=c.setFromMatrixPosition(e.matrixWorld),a=o.clone();a.project(t),n.setFromCamera(a,t);const i=n.intersectObjects(r,!0);if(i.length){const e=i[0].distance;return o.distanceTo(n.ray.origin)<e}return!0}(U.current,I,W,n);ne.current=e&&!t}else ne.current=!t;r!==ne.current&&(P?P(!ne.current):B.style.display=ne.current?"block":"none");const o=Math.floor(A[0]/2),a=_?K?[A[0],o]:[o-1,0]:A;if(B.style.zIndex=`${function(e,t,n){if(t instanceof i.PerspectiveCamera||t instanceof i.OrthographicCamera){const r=c.setFromMatrixPosition(e.matrixWorld),o=l.setFromMatrixPosition(t.matrixWorld),a=r.distanceTo(o),i=(n[1]-n[0])/(t.far-t.near),s=n[1]-i*t.far;return Math.round(i*a+s)}}(U.current,I,a)}`,S){const[e,t]=[H.width/2,H.height/2],n=I.projectionMatrix.elements[5]*t,{isOrthographicCamera:r,top:o,left:a,bottom:i,right:s}=I,c=h(I.matrixWorldInverse),l=r?`scale(${n})translate(${f(-(s+a)/2)}px,${f((o+i)/2)}px)`:`translateZ(${n}px)`;let u=U.current.matrixWorld;E&&(u=I.matrixWorldInverse.clone().transpose().copyPosition(u).scale(U.current.scale),u.elements[3]=u.elements[7]=u.elements[11]=0,u.elements[15]=1),B.style.width=H.width+"px",B.style.height=H.height+"px",B.style.perspective=r?"":`${n}px`,X.current&&Y.current&&(X.current.style.transform=`${l}${c}translate(${e}px,${t}px)`,Y.current.style.transform=((e,t)=>{return p(e,[1/(n=t),1/n,1/n,1,-1/n,-1/n,-1/n,-1,1/n,1/n,1/n,1,1,1,1,1],"translate(-50%,-50%)");var n})(u,1/((w||10)/400)))}else{const t=void 0===w?1:function(e,t){if(t instanceof i.OrthographicCamera)return t.zoom;if(t instanceof i.PerspectiveCamera){const n=c.setFromMatrixPosition(e.matrixWorld),r=l.setFromMatrixPosition(t.matrixWorld),o=t.fov*Math.PI/180,a=n.distanceTo(r);return 1/(2*Math.tan(o/2)*a)}return 1}(U.current,I)*w;B.style.transform=`translate3d(${e[0]}px,${e[1]}px,0) scale(${t})`}G.current=e,N.current=I.zoom}}if(!K&&Z.current&&!J.current)if(S){if(X.current){const e=X.current.children[0];if(null!=e&&e.clientWidth&&null!=e&&e.clientHeight){const{isOrthographicCamera:t}=I;if(t||j)T.scale&&(Array.isArray(T.scale)?T.scale instanceof i.Vector3?Z.current.scale.copy(T.scale.clone().divideScalar(1)):Z.current.scale.set(1/T.scale[0],1/T.scale[1],1/T.scale[2]):Z.current.scale.setScalar(1/T.scale));else{const t=(w||10)/400,n=e.clientWidth*t,r=e.clientHeight*t;Z.current.scale.set(n,r,1)}J.current=!0}}}else{const t=B.children[0];if(null!=t&&t.clientWidth&&null!=t&&t.clientHeight){const e=1/V.factor,n=t.clientWidth*e,r=t.clientHeight*e;Z.current.scale.set(n,r,1),J.current=!0}Z.current.lookAt(e.camera.position)}}));const re=o.useMemo((()=>({vertexShader:S?void 0:'\n          /*\n            This shader is from the THREE\'s SpriteMaterial.\n            We need to turn the backing plane into a Sprite\n            (make it always face the camera) if "transfrom" \n            is false. \n          */\n          #include <common>\n\n          void main() {\n            vec2 center = vec2(0., 1.);\n            float rotation = 0.0;\n            \n            // This is somewhat arbitrary, but it seems to work well\n            // Need to figure out how to derive this dynamically if it even matters\n            float size = 0.03;\n\n            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n            vec2 scale;\n            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\n            bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n            if ( isPerspective ) scale *= - mvPosition.z;\n\n            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;\n            vec2 rotatedPosition;\n            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n            mvPosition.xy += rotatedPosition;\n\n            gl_Position = projectionMatrix * mvPosition;\n          }\n      ',fragmentShader:"\n        void main() {\n          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n        }\n      "})),[S]);return o.createElement("group",(0,r.A)({},T,{ref:U}),_&&!K&&o.createElement("mesh",{castShadow:x,receiveShadow:M,ref:Z},j||o.createElement("planeGeometry",null),C||o.createElement("shaderMaterial",{side:i.DoubleSide,vertexShader:re.vertexShader,fragmentShader:re.fragmentShader})))}))},2402:(e,t,n)=>{n.d(t,{a:()=>l});var r=n(6540),o=n(9437);const a="undefined"==typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?r.useEffect:r.useLayoutEffect;let i=0;const s=function(e){const t=function(e){let t;const n=new Set,r=(e,r)=>{const o="function"==typeof e?e(t):e;if(o!==t){const e=t;t=r?o:Object.assign({},t,o),n.forEach((n=>n(t,e)))}},o=()=>t,a={setState:r,getState:o,subscribe:(e,r,a)=>r||a?((e,r=o,a=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let i=r(t);function s(){const n=r(t);if(!a(i,n)){const t=i;e(i=n,t)}}return n.add(s),()=>n.delete(s)})(e,r,a):(n.add(e),()=>n.delete(e)),destroy:()=>n.clear()};return t=e(r,o,a),a}(e),n=(e=t.getState,n=Object.is)=>{const[,o]=(0,r.useReducer)((e=>e+1),0),i=t.getState(),s=(0,r.useRef)(i),c=(0,r.useRef)(e),l=(0,r.useRef)(n),u=(0,r.useRef)(!1),d=(0,r.useRef)();let f;void 0===d.current&&(d.current=e(i));let p=!1;(s.current!==i||c.current!==e||l.current!==n||u.current)&&(f=e(i),p=!n(d.current,f)),a((()=>{p&&(d.current=f),s.current=i,c.current=e,l.current=n,u.current=!1}));const h=(0,r.useRef)(i);a((()=>{const e=()=>{try{const e=t.getState(),n=c.current(e);l.current(d.current,n)||(s.current=e,d.current=n,o())}catch(e){u.current=!0,o()}},n=t.subscribe(e);return t.getState()!==h.current&&e(),n}),[]);const m=p?f:d.current;return(0,r.useDebugValue)(m),m};return Object.assign(n,t),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const e=[n,t];return{next(){const t=e.length<=0;return{value:e.shift(),done:t}}}},n}((e=>(o.DefaultLoadingManager.onStart=(t,n,r)=>{e({active:!0,item:t,loaded:n,total:r,progress:(n-i)/(r-i)*100})},o.DefaultLoadingManager.onLoad=()=>{e({active:!1})},o.DefaultLoadingManager.onError=t=>e((e=>({errors:[...e.errors,t]}))),o.DefaultLoadingManager.onProgress=(t,n,r)=>{n===r&&(i=r),e({active:!0,item:t,loaded:n,total:r,progress:(n-i)/(r-i)*100||100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0}))),c=e=>`Loading ${e.toFixed(2)}%`;function l({containerStyles:e,innerStyles:t,barStyles:n,dataStyles:o,dataInterpolation:a=c,initialState:i=e=>e}){const{active:l,progress:d}=s(),f=r.useRef(0),p=r.useRef(0),h=r.useRef(null),[m,v]=r.useState(i(l));r.useEffect((()=>{let e;return l!==m&&(e=setTimeout((()=>v(l)),300)),()=>clearTimeout(e)}),[m,l]);const g=r.useCallback((()=>{h.current&&(f.current+=(d-f.current)/2,(f.current>.95*d||100===d)&&(f.current=d),h.current.innerText=a(f.current),f.current<d&&(p.current=requestAnimationFrame(g)))}),[a,d]);return r.useEffect((()=>(g(),()=>cancelAnimationFrame(p.current))),[g]),m?r.createElement("div",{style:{...u.container,opacity:l?1:0,...e}},r.createElement("div",null,r.createElement("div",{style:{...u.inner,...t}},r.createElement("div",{style:{...u.bar,transform:`scaleX(${d/100})`,...n}}),r.createElement("span",{ref:h,style:{...u.data,...o}})))):null}const u={container:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"#171717",display:"flex",alignItems:"center",justifyContent:"center",transition:"opacity 300ms ease",zIndex:1e3},inner:{width:100,height:3,background:"#272727",textAlign:"center"},bar:{height:3,width:"100%",background:"white",transition:"transform 200ms",transformOrigin:"left center"},data:{display:"inline-block",position:"relative",fontVariantNumeric:"tabular-nums",marginTop:"0.8em",color:"#f0f0f0",fontSize:"0.6em",fontFamily:'-apple-system, BlinkMacSystemFont, "Inter", "Segoe UI", "Helvetica Neue", Helvetica, Arial, Roboto, Ubuntu, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',whiteSpace:"nowrap"}}},9689:(e,t,n)=>{n.d(t,{A:()=>ee,B:()=>E,D:()=>ne,E:()=>S,a:()=>b,b:()=>ue,c:()=>H,d:()=>fe,e:()=>f,i:()=>y,u:()=>w,z:()=>K});var r=n(9437),o=n(6540),a=n(772);const i="undefined"==typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?o.useEffect:o.useLayoutEffect;var s=n(4845),c=n.n(s),l=n(9982),u=n(6749);const d={},f=e=>{Object.assign(d,e)};var p,h;const m=e=>"colorSpace"in e||"outputColorSpace"in e,v=()=>{var e;return null!=(e=d.ColorManagement)?e:null},g=e=>e&&e.isOrthographicCamera,y=e=>e&&e.hasOwnProperty("current"),b="undefined"!=typeof window&&(null!=(p=window.document)&&p.createElement||"ReactNative"===(null==(h=window.navigator)?void 0:h.product))?o.useLayoutEffect:o.useEffect;function w(e){const t=o.useRef(e);return b((()=>{t.current=e}),[e]),t}function E({set:e}){return b((()=>(e(new Promise((()=>null))),()=>e(!1))),[e]),null}class S extends o.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}S.getDerivedStateFromError=()=>({error:!0});const _="__default",P=new Map;function x(e){var t;const n="undefined"!=typeof window?null!=(t=window.devicePixelRatio)?t:2:1;return Array.isArray(e)?Math.min(Math.max(e[0],n),e[1]):e}const M=e=>{var t;return null==(t=e.__r3f)?void 0:t.root.getState()},C={obj:e=>e===Object(e)&&!C.arr(e)&&"function"!=typeof e,fun:e=>"function"==typeof e,str:e=>"string"==typeof e,num:e=>"number"==typeof e,boo:e=>"boolean"==typeof e,und:e=>void 0===e,arr:e=>Array.isArray(e),equ(e,t,{arrays:n="shallow",objects:r="reference",strict:o=!0}={}){if(typeof e!=typeof t||!!e!=!!t)return!1;if(C.str(e)||C.num(e))return e===t;const a=C.obj(e);if(a&&"reference"===r)return e===t;const i=C.arr(e);if(i&&"reference"===n)return e===t;if((i||a)&&e===t)return!0;let s;for(s in e)if(!(s in t))return!1;if(a&&"shallow"===n&&"shallow"===r){for(s in o?t:e)if(!C.equ(e[s],t[s],{strict:o,objects:"reference"}))return!1}else for(s in o?t:e)if(e[s]!==t[s])return!1;if(C.und(s)){if(i&&0===e.length&&0===t.length)return!0;if(a&&0===Object.keys(e).length&&0===Object.keys(t).length)return!0;if(e!==t)return!1}return!0}};function j(e,t){const n=e;return(null!=t&&t.primitive||!n.__r3f)&&(n.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...t}),e}function A(e,t){let n=e;if(t.includes("-")){const r=t.split("-"),o=r.pop();return n=r.reduce(((e,t)=>e[t]),e),{target:n,key:o}}return{target:n,key:t}}const O=/-\d+$/;function R(e,t,n){if(C.str(n)){if(O.test(n)){const t=n.replace(O,""),{target:r,key:o}=A(e,t);Array.isArray(r[o])||(r[o]=[])}const{target:r,key:o}=A(e,n);t.__r3f.previousAttach=r[o],r[o]=t}else t.__r3f.previousAttach=n(e,t)}function k(e,t,n){var r,o;if(C.str(n)){const{target:r,key:o}=A(e,n),a=t.__r3f.previousAttach;void 0===a?delete r[o]:r[o]=a}else null==(r=t.__r3f)||null==r.previousAttach||r.previousAttach(e,t);null==(o=t.__r3f)||delete o.previousAttach}function z(e,{children:t,key:n,ref:r,...o},{children:a,key:i,ref:s,...c}={},l=!1){var u;const d=null!=(u=null==e?void 0:e.__r3f)?u:{},f=Object.entries(o),p=[];if(l){const e=Object.keys(c);for(let t=0;t<e.length;t++)o.hasOwnProperty(e[t])||f.unshift([e[t],_+"remove"])}f.forEach((([t,n])=>{var r;if(null!=(r=e.__r3f)&&r.primitive&&"object"===t)return;if(C.equ(n,c[t]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(t))return p.push([t,n,!0,[]]);let a=[];t.includes("-")&&(a=t.split("-")),p.push([t,n,!1,a]);for(const e in o){const n=o[e];e.startsWith(`${t}-`)&&p.push([e,n,!1,e.split("-")])}}));const h={...o};return d.memoizedProps&&d.memoizedProps.args&&(h.args=d.memoizedProps.args),d.memoizedProps&&d.memoizedProps.attach&&(h.attach=d.memoizedProps.attach),{memoized:h,changes:p}}function T(e,t){var n,o,a;const i=null!=(n=e.__r3f)?n:{},s=i.root,c=null!=(o=null==s||null==s.getState?void 0:s.getState())?o:{},{memoized:l,changes:u}=(f=t)&&f.memoized&&f.changes?t:z(e,t),d=i.eventCount;var f;e.__r3f&&(e.__r3f.memoizedProps=l);for(let t=0;t<u.length;t++){let[n,o,a,s]=u[t];if(m(e)){const e=3001,t="srgb",r="srgb-linear";"encoding"===n?(n="colorSpace",o=o===e?t:r):"outputEncoding"===n&&(n="outputColorSpace",o=o===e?t:r)}let l=e,d=l[n];if(s.length&&(d=s.reduce(((e,t)=>e[t]),e),!d||!d.set)){const[t,...r]=s.reverse();l=r.reverse().reduce(((e,t)=>e[t]),e),n=t}if(o===_+"remove")if(l.constructor){let e=P.get(l.constructor);e||(e=new l.constructor,P.set(l.constructor,e)),o=e[n]}else o=0;if(a)o?i.handlers[n]=o:delete i.handlers[n],i.eventCount=Object.keys(i.handlers).length;else if(d&&d.set&&(d.copy||d instanceof r.Layers)){if(Array.isArray(o))d.fromArray?d.fromArray(o):d.set(...o);else if(d.copy&&o&&o.constructor&&d.constructor===o.constructor)d.copy(o);else if(void 0!==o){const e=d instanceof r.Color;!e&&d.setScalar?d.setScalar(o):d instanceof r.Layers&&o instanceof r.Layers?d.mask=o.mask:d.set(o),v()||c.linear||!e||d.convertSRGBToLinear()}}else if(l[n]=o,l[n]instanceof r.Texture&&l[n].format===r.RGBAFormat&&l[n].type===r.UnsignedByteType){const e=l[n];m(e)&&m(c.gl)?e.colorSpace=c.gl.outputColorSpace:e.encoding=c.gl.outputEncoding}L(e)}if(i.parent&&c.internal&&e.raycast&&d!==i.eventCount){const t=c.internal.interaction.indexOf(e);t>-1&&c.internal.interaction.splice(t,1),i.eventCount&&c.internal.interaction.push(e)}return!(1===u.length&&"onUpdate"===u[0][0])&&u.length&&null!=(a=e.__r3f)&&a.parent&&D(e),e}function L(e){var t,n;const r=null==(t=e.__r3f)||null==(n=t.root)||null==n.getState?void 0:n.getState();r&&0===r.internal.frames&&r.invalidate()}function D(e){null==e.onUpdate||e.onUpdate(e)}function I(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function F(e,t,n,r){const o=n.get(t);o&&(n.delete(t),0===n.size&&(e.delete(r),o.target.releasePointerCapture(r)))}function H(e){function t(e){return e.filter((e=>["Move","Over","Enter","Out","Leave"].some((t=>{var n;return null==(n=e.__r3f)?void 0:n.handlers["onPointer"+t]}))))}function n(t){const{internal:n}=e.getState();for(const e of n.hovered.values())if(!t.length||!t.find((t=>t.object===e.object&&t.index===e.index&&t.instanceId===e.instanceId))){const r=e.eventObject.__r3f,o=null==r?void 0:r.handlers;if(n.hovered.delete(I(e)),null!=r&&r.eventCount){const n={...e,intersections:t};null==o.onPointerOut||o.onPointerOut(n),null==o.onPointerLeave||o.onPointerLeave(n)}}}function o(e,t){for(let n=0;n<t.length;n++){const r=t[n].__r3f;null==r||null==r.handlers.onPointerMissed||r.handlers.onPointerMissed(e)}}return{handlePointer:function(a){switch(a){case"onPointerLeave":case"onPointerCancel":return()=>n([]);case"onLostPointerCapture":return t=>{const{internal:r}=e.getState();"pointerId"in t&&r.capturedMap.has(t.pointerId)&&requestAnimationFrame((()=>{r.capturedMap.has(t.pointerId)&&(r.capturedMap.delete(t.pointerId),n([]))}))}}return function(i){const{onPointerMissed:s,internal:c}=e.getState();c.lastEvent.current=i;const l="onPointerMove"===a,u="onClick"===a||"onContextMenu"===a||"onDoubleClick"===a,d=function(t,n){const r=e.getState(),o=new Set,a=[],i=n?n(r.internal.interaction):r.internal.interaction;for(let e=0;e<i.length;e++){const t=M(i[e]);t&&(t.raycaster.camera=void 0)}r.previousRoot||null==r.events.compute||r.events.compute(t,r);let s=i.flatMap((function(e){const n=M(e);return n&&n.events.enabled&&null!==n.raycaster.camera?(void 0===n.raycaster.camera&&(null==n.events.compute||n.events.compute(t,n,null==(r=n.previousRoot)?void 0:r.getState()),void 0===n.raycaster.camera&&(n.raycaster.camera=null)),n.raycaster.camera?n.raycaster.intersectObject(e,!0):[]):[];var r})).sort(((e,t)=>{const n=M(e.object),r=M(t.object);return n&&r&&r.events.priority-n.events.priority||e.distance-t.distance})).filter((e=>{const t=I(e);return!o.has(t)&&(o.add(t),!0)}));r.events.filter&&(s=r.events.filter(s,r));for(const e of s){let t=e.object;for(;t;){var c;null!=(c=t.__r3f)&&c.eventCount&&a.push({...e,eventObject:t}),t=t.parent}}if("pointerId"in t&&r.internal.capturedMap.has(t.pointerId))for(let e of r.internal.capturedMap.get(t.pointerId).values())o.has(I(e.intersection))||a.push(e.intersection);return a}(i,l?t:void 0),f=u?function(t){const{internal:n}=e.getState(),r=t.offsetX-n.initialClick[0],o=t.offsetY-n.initialClick[1];return Math.round(Math.sqrt(r*r+o*o))}(i):0;"onPointerDown"===a&&(c.initialClick=[i.offsetX,i.offsetY],c.initialHits=d.map((e=>e.eventObject))),u&&!d.length&&f<=2&&(o(i,c.interaction),s&&s(i)),l&&n(d),function(t,o,a,i){const s=e.getState();if(t.length){const e={stopped:!1};for(const c of t){const l=M(c.object)||s,{raycaster:u,pointer:d,camera:f,internal:p}=l,h=new r.Vector3(d.x,d.y,0).unproject(f),m=e=>{var t,n;return null!=(t=null==(n=p.capturedMap.get(e))?void 0:n.has(c.eventObject))&&t},v=e=>{const t={intersection:c,target:o.target};p.capturedMap.has(e)?p.capturedMap.get(e).set(c.eventObject,t):p.capturedMap.set(e,new Map([[c.eventObject,t]])),o.target.setPointerCapture(e)},g=e=>{const t=p.capturedMap.get(e);t&&F(p.capturedMap,c.eventObject,t,e)};let y={};for(let e in o){let t=o[e];"function"!=typeof t&&(y[e]=t)}let b={...c,...y,pointer:d,intersections:t,stopped:e.stopped,delta:a,unprojectedPoint:h,ray:u.ray,camera:f,stopPropagation(){const r="pointerId"in o&&p.capturedMap.get(o.pointerId);(!r||r.has(c.eventObject))&&(b.stopped=e.stopped=!0,p.hovered.size&&Array.from(p.hovered.values()).find((e=>e.eventObject===c.eventObject)))&&n([...t.slice(0,t.indexOf(c)),c])},target:{hasPointerCapture:m,setPointerCapture:v,releasePointerCapture:g},currentTarget:{hasPointerCapture:m,setPointerCapture:v,releasePointerCapture:g},nativeEvent:o};if(i(b),!0===e.stopped)break}}}(d,i,f,(function(e){const t=e.eventObject,n=t.__r3f,r=null==n?void 0:n.handlers;if(null!=n&&n.eventCount)if(l){if(r.onPointerOver||r.onPointerEnter||r.onPointerOut||r.onPointerLeave){const t=I(e),n=c.hovered.get(t);n?n.stopped&&e.stopPropagation():(c.hovered.set(t,e),null==r.onPointerOver||r.onPointerOver(e),null==r.onPointerEnter||r.onPointerEnter(e))}null==r.onPointerMove||r.onPointerMove(e)}else{const n=r[a];n?u&&!c.initialHits.includes(t)||(o(i,c.interaction.filter((e=>!c.initialHits.includes(e)))),n(e)):u&&c.initialHits.includes(t)&&o(i,c.interaction.filter((e=>!c.initialHits.includes(e))))}}))}}}}const W=e=>!(null==e||!e.render),$=o.createContext(null),V=(e,t)=>{const n=function(e){const t=function(e){let t;const n=new Set,r=(e,r)=>{const o="function"==typeof e?e(t):e;if(o!==t){const e=t;t=r?o:Object.assign({},t,o),n.forEach((n=>n(t,e)))}},o=()=>t,a={setState:r,getState:o,subscribe:(e,r,a)=>r||a?((e,r=o,a=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let i=r(t);function s(){const n=r(t);if(!a(i,n)){const t=i;e(i=n,t)}}return n.add(s),()=>n.delete(s)})(e,r,a):(n.add(e),()=>n.delete(e)),destroy:()=>n.clear()};return t=e(r,o,a),a}(e),n=(e=t.getState,n=Object.is)=>{const[,r]=(0,o.useReducer)((e=>e+1),0),a=t.getState(),s=(0,o.useRef)(a),c=(0,o.useRef)(e),l=(0,o.useRef)(n),u=(0,o.useRef)(!1),d=(0,o.useRef)();let f;void 0===d.current&&(d.current=e(a));let p=!1;(s.current!==a||c.current!==e||l.current!==n||u.current)&&(f=e(a),p=!n(d.current,f)),i((()=>{p&&(d.current=f),s.current=a,c.current=e,l.current=n,u.current=!1}));const h=(0,o.useRef)(a);i((()=>{const e=()=>{try{const e=t.getState(),n=c.current(e);l.current(d.current,n)||(s.current=e,d.current=n,r())}catch(e){u.current=!0,r()}},n=t.subscribe(e);return t.getState()!==h.current&&e(),n}),[]);const m=p?f:d.current;return(0,o.useDebugValue)(m),m};return Object.assign(n,t),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const e=[n,t];return{next(){const t=e.length<=0;return{value:e.shift(),done:t}}}},n}(((n,a)=>{const i=new r.Vector3,s=new r.Vector3,c=new r.Vector3;function l(e=a().camera,t=s,n=a().size){const{width:o,height:l,top:u,left:d}=n,f=o/l;t instanceof r.Vector3?c.copy(t):c.set(...t);const p=e.getWorldPosition(i).distanceTo(c);if(g(e))return{width:o/e.zoom,height:l/e.zoom,top:u,left:d,factor:1,distance:p,aspect:f};{const t=e.fov*Math.PI/180,n=2*Math.tan(t/2)*p,r=n*(o/l);return{width:r,height:n,top:u,left:d,factor:o/r,distance:p,aspect:f}}}let u;const d=e=>n((t=>({performance:{...t.performance,current:e}}))),f=new r.Vector2,p={set:n,get:a,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(t=1)=>e(a(),t),advance:(e,n)=>t(e,n,a()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new r.Clock,pointer:f,mouse:f,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const e=a();u&&clearTimeout(u),e.performance.current!==e.performance.min&&d(e.performance.min),u=setTimeout((()=>d(a().performance.max)),e.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:l},setEvents:e=>n((t=>({...t,events:{...t.events,...e}}))),setSize:(e,t,r,o,i)=>{const c=a().camera,u={width:e,height:t,top:o||0,left:i||0,updateStyle:r};n((e=>({size:u,viewport:{...e.viewport,...l(c,s,u)}})))},setDpr:e=>n((t=>{const n=x(e);return{viewport:{...t.viewport,dpr:n,initialDpr:t.viewport.initialDpr||n}}})),setFrameloop:(e="always")=>{const t=a().clock;t.stop(),t.elapsedTime=0,"never"!==e&&(t.start(),t.elapsedTime=0),n((()=>({frameloop:e})))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:o.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(e,t,n)=>{const r=a().internal;return r.priority=r.priority+(t>0?1:0),r.subscribers.push({ref:e,priority:t,store:n}),r.subscribers=r.subscribers.sort(((e,t)=>e.priority-t.priority)),()=>{const n=a().internal;null!=n&&n.subscribers&&(n.priority=n.priority-(t>0?1:0),n.subscribers=n.subscribers.filter((t=>t.ref!==e)))}}}};return p})),a=n.getState();let s=a.size,c=a.viewport.dpr,l=a.camera;return n.subscribe((()=>{const{camera:e,size:t,viewport:r,gl:o,set:a}=n.getState();if(t!==s||r.dpr!==c){var i;s=t,c=r.dpr,function(e,t){e.manual||(g(e)?(e.left=t.width/-2,e.right=t.width/2,e.top=t.height/2,e.bottom=t.height/-2):e.aspect=t.width/t.height,e.updateProjectionMatrix(),e.updateMatrixWorld())}(e,t),o.setPixelRatio(r.dpr);const n=null!=(i=t.updateStyle)?i:"undefined"!=typeof HTMLCanvasElement&&o.domElement instanceof HTMLCanvasElement;o.setSize(t.width,t.height,n)}e!==l&&(l=e,a((t=>({viewport:{...t.viewport,...t.viewport.getCurrentViewport(e)}}))))})),n.subscribe((t=>e(t))),n};let B,q,U,N=new Set,G=new Set,X=new Set;function Y(e,t){if(e.size)for(const{callback:n}of e.values())n(t)}function Q(e,t){switch(e){case"before":return Y(N,t);case"after":return Y(G,t);case"tail":return Y(X,t)}}function Z(e,t,n){let r=t.clock.getDelta();for("never"===t.frameloop&&"number"==typeof e&&(r=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),q=t.internal.subscribers,B=0;B<q.length;B++)U=q[B],U.ref.current(U.store.getState(),r,n);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),"always"===t.frameloop?1:t.internal.frames}function J(){const e=o.useContext($);if(!e)throw new Error("R3F: Hooks can only be used within the Canvas component!");return e}function K(e=e=>e,t){return J()(e,t)}function ee(e,t=0){const n=J(),r=n.getState().internal.subscribe,o=w(e);return b((()=>r(o,t,n)),[t,r,n]),null}function te(e,t){return function(n,...r){const o=new n;return e&&e(o),Promise.all(r.map((e=>new Promise(((n,r)=>o.load(e,(e=>{e.scene&&Object.assign(e,function(e){const t={nodes:{},materials:{}};return e&&e.traverse((e=>{e.name&&(t.nodes[e.name]=e),e.material&&!t.materials[e.material.name]&&(t.materials[e.material.name]=e.material)})),t}(e.scene)),n(e)}),t,(t=>r(new Error(`Could not load ${e}: ${t.message})`)))))))))}}function ne(e,t,n,r){const o=Array.isArray(t)?t:[t],a=(0,u.DY)(te(n,r),[e,...o],{equal:C.equ});return Array.isArray(t)?a:a[0]}ne.preload=function(e,t,n){const r=Array.isArray(t)?t:[t];return(0,u.uv)(te(n),[e,...r])},ne.clear=function(e,t){const n=Array.isArray(t)?t:[t];return(0,u.IU)([e,...n])};const re=new Map,{invalidate:oe,advance:ae}=function(e){let t,n,r,o=!1;function a(i){n=requestAnimationFrame(a),o=!0,t=0,Q("before",i);for(const n of e.values()){var s;r=n.store.getState(),!r.internal.active||!("always"===r.frameloop||r.internal.frames>0)||null!=(s=r.gl.xr)&&s.isPresenting||(t+=Z(i,r))}if(Q("after",i),0===t)return Q("tail",i),o=!1,cancelAnimationFrame(n)}return{loop:a,invalidate:function t(n,r=1){var i;if(!n)return e.forEach((e=>t(e.store.getState())),r);null!=(i=n.gl.xr)&&i.isPresenting||!n.internal.active||"never"===n.frameloop||(n.internal.frames=Math.min(60,n.internal.frames+r),o||(o=!0,requestAnimationFrame(a)))},advance:function(t,n=!0,r,o){if(n&&Q("before",t),r)Z(t,r,o);else for(const n of e.values())Z(t,n.store.getState());n&&Q("after",t)}}}(re),{reconciler:ie,applyProps:se}=function(e,t){function n(e,{args:t=[],attach:n,...o},a){let i,s=`${e[0].toUpperCase()}${e.slice(1)}`;if("primitive"===e){if(void 0===o.object)throw new Error("R3F: Primitives without 'object' are invalid!");i=j(o.object,{type:e,root:a,attach:n,primitive:!0})}else{const r=d[s];if(!r)throw new Error(`R3F: ${s} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(t))throw new Error("R3F: The args prop must be an array!");i=j(new r(...t),{type:e,root:a,attach:n,memoizedProps:{args:t}})}return void 0===i.__r3f.attach&&(i instanceof r.BufferGeometry?i.__r3f.attach="geometry":i instanceof r.Material&&(i.__r3f.attach="material")),"inject"!==s&&T(i,o),i}function o(e,t){let n=!1;var r,o;t&&(null!=(r=t.__r3f)&&r.attach?R(e,t,t.__r3f.attach):t.isObject3D&&e.isObject3D&&(e.add(t),n=!0),n||null==(o=e.__r3f)||o.objects.push(t),t.__r3f||j(t,{}),t.__r3f.parent=e,D(t),L(t))}function i(e,t,n){let r=!1;if(t){var o,a;if(null!=(o=t.__r3f)&&o.attach)R(e,t,t.__r3f.attach);else if(t.isObject3D&&e.isObject3D){t.parent=e,t.dispatchEvent({type:"added"});const o=e.children.filter((e=>e!==t)),a=o.indexOf(n);e.children=[...o.slice(0,a),t,...o.slice(a)],r=!0}r||null==(a=e.__r3f)||a.objects.push(t),t.__r3f||j(t,{}),t.__r3f.parent=e,D(t),L(t)}}function s(e,t,n=!1){e&&[...e].forEach((e=>u(t,e,n)))}function u(e,t,n){if(t){var r,o,a;if(t.__r3f&&(t.__r3f.parent=null),null!=(r=e.__r3f)&&r.objects&&(e.__r3f.objects=e.__r3f.objects.filter((e=>e!==t))),null!=(o=t.__r3f)&&o.attach)k(e,t,t.__r3f.attach);else if(t.isObject3D&&e.isObject3D){var i;e.remove(t),null!=(i=t.__r3f)&&i.root&&function(e,t){const{internal:n}=e.getState();n.interaction=n.interaction.filter((e=>e!==t)),n.initialHits=n.initialHits.filter((e=>e!==t)),n.hovered.forEach(((e,r)=>{e.eventObject!==t&&e.object!==t||n.hovered.delete(r)})),n.capturedMap.forEach(((e,r)=>{F(n.capturedMap,t,e,r)}))}(t.__r3f.root,t)}const u=null==(a=t.__r3f)?void 0:a.primitive,d=void 0===n?null!==t.dispose&&!u:n;var c;u||(s(null==(c=t.__r3f)?void 0:c.objects,t,d),s(t.children,t,d)),delete t.__r3f,d&&t.dispose&&"Scene"!==t.type&&(0,l.unstable_scheduleCallback)(l.unstable_IdlePriority,(()=>{try{t.dispose()}catch(e){}})),L(e)}}const f=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:c()({createInstance:n,removeChild:u,appendChild:o,appendInitialChild:o,insertBefore:i,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(e,t)=>{if(!t)return;const n=e.getState().scene;n.__r3f&&(n.__r3f.root=e,o(n,t))},removeChildFromContainer:(e,t)=>{t&&u(e.getState().scene,t)},insertInContainerBefore:(e,t,n)=>{if(!t||!n)return;const r=e.getState().scene;r.__r3f&&i(r,t,n)},getRootHostContext:()=>null,getChildHostContext:e=>e,finalizeInitialChildren(e){var t;const n=null!=(t=null==e?void 0:e.__r3f)?t:{};return Boolean(n.handlers)},prepareUpdate(e,t,n,r){if(e.__r3f.primitive&&r.object&&r.object!==e)return[!0];{const{args:t=[],children:o,...a}=r,{args:i=[],children:s,...c}=n;if(!Array.isArray(t))throw new Error("R3F: the args prop must be an array!");if(t.some(((e,t)=>e!==i[t])))return[!0];const l=z(e,a,c,!0);return l.changes.length?[!1,l]:null}},commitUpdate(e,[t,r],a,i,s,c){t?function(e,t,r,a){var i;const s=null==(i=e.__r3f)?void 0:i.parent;if(!s)return;const c=n(t,r,e.__r3f.root);if(e.children){for(const t of e.children)t.__r3f&&o(c,t);e.children=e.children.filter((e=>!e.__r3f))}e.__r3f.objects.forEach((e=>o(c,e))),e.__r3f.objects=[],e.__r3f.autoRemovedBeforeAppend||u(s,e),c.parent&&(c.__r3f.autoRemovedBeforeAppend=!0),o(s,c),c.raycast&&c.__r3f.eventCount&&c.__r3f.root.getState().internal.interaction.push(c),[a,a.alternate].forEach((e=>{null!==e&&(e.stateNode=c,e.ref&&("function"==typeof e.ref?e.ref(c):e.ref.current=c))}))}(e,a,s,c):T(e,r)},commitMount(e,t,n,r){var o;const a=null!=(o=e.__r3f)?o:{};e.raycast&&a.handlers&&a.eventCount&&e.__r3f.root.getState().internal.interaction.push(e)},getPublicInstance:e=>e,prepareForCommit:()=>null,preparePortalMount:e=>j(e.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(e){var t;const{attach:n,parent:r}=null!=(t=e.__r3f)?t:{};n&&r&&k(r,e,n),e.isObject3D&&(e.visible=!1),L(e)},unhideInstance(e,t){var n;const{attach:r,parent:o}=null!=(n=e.__r3f)?n:{};r&&o&&R(o,e,r),(e.isObject3D&&null==t.visible||t.visible)&&(e.visible=!0),L(e)},createTextInstance:f,hideTextInstance:f,unhideTextInstance:f,getCurrentEventPriority:()=>t?t():a.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:"undefined"!=typeof performance&&C.fun(performance.now)?performance.now:C.fun(Date.now)?Date.now:()=>0,scheduleTimeout:C.fun(setTimeout)?setTimeout:void 0,cancelTimeout:C.fun(clearTimeout)?clearTimeout:void 0}),applyProps:T}}(0,(function(){var e;const t="undefined"!=typeof self&&self||"undefined"!=typeof window&&window;if(!t)return a.DefaultEventPriority;switch(null==(e=t.event)?void 0:e.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return a.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return a.ContinuousEventPriority;default:return a.DefaultEventPriority}})),ce={objects:"shallow",strict:!1},le=(e,t)=>{const n="function"==typeof e?e(t):e;return W(n)?n:new r.WebGLRenderer({powerPreference:"high-performance",canvas:t,antialias:!0,alpha:!0,...e})};function ue(e){const t=re.get(e),n=null==t?void 0:t.fiber,i=null==t?void 0:t.store;t&&console.warn("R3F.createRoot should only be called once!");const s="function"==typeof reportError?reportError:console.error,c=i||V(oe,ae),l=n||ie.createContainer(c,a.ConcurrentRoot,null,!1,null,"",s,null);let u;t||re.set(e,{fiber:l,store:c});let d,f=!1;return{configure(t={}){let{gl:n,size:o,scene:a,events:i,onCreated:s,shadows:l=!1,linear:p=!1,flat:h=!1,legacy:m=!1,orthographic:g=!1,frameloop:y="always",dpr:b=[1,2],performance:w,raycaster:E,camera:S,onPointerMissed:_}=t,P=c.getState(),M=P.gl;P.gl||P.set({gl:M=le(n,e)});let A=P.raycaster;A||P.set({raycaster:A=new r.Raycaster});const{params:O,...R}=E||{};if(C.equ(R,A,ce)||se(A,{...R}),C.equ(O,A.params,ce)||se(A,{params:{...A.params,...O}}),!P.camera||P.camera===d&&!C.equ(d,S,ce)){d=S;const e=S instanceof r.Camera,t=e?S:g?new r.OrthographicCamera(0,0,0,0,.1,1e3):new r.PerspectiveCamera(75,0,.1,1e3);e||(t.position.z=5,S&&se(t,S),P.camera||null!=S&&S.rotation||t.lookAt(0,0,0)),P.set({camera:t})}if(!P.scene){let e;a instanceof r.Scene?e=a:(e=new r.Scene,a&&se(e,a)),P.set({scene:j(e)})}if(!P.xr){const e=(e,t)=>{const n=c.getState();"never"!==n.frameloop&&ae(e,!0,n,t)},t=()=>{const t=c.getState();t.gl.xr.enabled=t.gl.xr.isPresenting,t.gl.xr.setAnimationLoop(t.gl.xr.isPresenting?e:null),t.gl.xr.isPresenting||oe(t)},n={connect(){const e=c.getState().gl;e.xr.addEventListener("sessionstart",t),e.xr.addEventListener("sessionend",t)},disconnect(){const e=c.getState().gl;e.xr.removeEventListener("sessionstart",t),e.xr.removeEventListener("sessionend",t)}};M.xr&&n.connect(),P.set({xr:n})}if(M.shadowMap){const e=M.shadowMap.enabled,t=M.shadowMap.type;if(M.shadowMap.enabled=!!l,C.boo(l))M.shadowMap.type=r.PCFSoftShadowMap;else if(C.str(l)){var k;const e={basic:r.BasicShadowMap,percentage:r.PCFShadowMap,soft:r.PCFSoftShadowMap,variance:r.VSMShadowMap};M.shadowMap.type=null!=(k=e[l])?k:r.PCFSoftShadowMap}else C.obj(l)&&Object.assign(M.shadowMap,l);e===M.shadowMap.enabled&&t===M.shadowMap.type||(M.shadowMap.needsUpdate=!0)}const z=v();z&&("enabled"in z?z.enabled=!m:"legacyMode"in z&&(z.legacyMode=m)),se(M,{outputEncoding:p?3e3:3001,toneMapping:h?r.NoToneMapping:r.ACESFilmicToneMapping}),P.legacy!==m&&P.set((()=>({legacy:m}))),P.linear!==p&&P.set((()=>({linear:p}))),P.flat!==h&&P.set((()=>({flat:h}))),!n||C.fun(n)||W(n)||C.equ(n,M,ce)||se(M,n),i&&!P.events.handlers&&P.set({events:i(c)});const T=function(e,t){if(t)return t;if("undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement&&e.parentElement){const{width:t,height:n,top:r,left:o}=e.parentElement.getBoundingClientRect();return{width:t,height:n,top:r,left:o}}return"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas?{width:e.width,height:e.height,top:0,left:0}:{width:0,height:0,top:0,left:0}}(e,o);return C.equ(T,P.size,ce)||P.setSize(T.width,T.height,T.updateStyle,T.top,T.left),b&&P.viewport.dpr!==x(b)&&P.setDpr(b),P.frameloop!==y&&P.setFrameloop(y),P.onPointerMissed||P.set({onPointerMissed:_}),w&&!C.equ(w,P.performance,ce)&&P.set((e=>({performance:{...e.performance,...w}}))),u=s,f=!0,this},render(t){return f||this.configure(),ie.updateContainer(o.createElement(de,{store:c,children:t,onCreated:u,rootElement:e}),l,null,(()=>{})),c},unmount(){fe(e)}}}function de({store:e,children:t,onCreated:n,rootElement:r}){return b((()=>{const t=e.getState();t.set((e=>({internal:{...e.internal,active:!0}}))),n&&n(t),e.getState().events.connected||null==t.events.connect||t.events.connect(r)}),[]),o.createElement($.Provider,{value:e},t)}function fe(e,t){const n=re.get(e),r=null==n?void 0:n.fiber;if(r){const o=null==n?void 0:n.store.getState();o&&(o.internal.active=!1),ie.updateContainer(null,r,null,(()=>{o&&setTimeout((()=>{try{var n,r,a,i;null==o.events.disconnect||o.events.disconnect(),null==(n=o.gl)||null==(r=n.renderLists)||null==r.dispose||r.dispose(),null==(a=o.gl)||null==a.forceContextLoss||a.forceContextLoss(),null!=(i=o.gl)&&i.xr&&o.xr.disconnect(),function(e){e.dispose&&"Scene"!==e.type&&e.dispose();for(const t in e)null==t.dispose||t.dispose(),delete e[t]}(o),re.delete(e),t&&t(e)}catch(e){}}),500)}))}}ie.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:o.version}),o.unstable_act},7859:(e,t,n)=>{n.d(t,{Hl:()=>f});var r=n(9689),o=n(8168),a=n(6540),i=n(9437),s=n(9154),c=n(9318);n(772),n(4845),n(9982);const l={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function u(e){const{handlePointer:t}=(0,r.c)(e);return{priority:1,enabled:!0,compute(e,t,n){t.pointer.set(e.offsetX/t.size.width*2-1,-e.offsetY/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)},connected:void 0,handlers:Object.keys(l).reduce(((e,n)=>({...e,[n]:t(n)})),{}),update:()=>{var t;const{events:n,internal:r}=e.getState();null!=(t=r.lastEvent)&&t.current&&n.handlers&&n.handlers.onPointerMove(r.lastEvent.current)},connect:t=>{var n;const{set:r,events:o}=e.getState();null==o.disconnect||o.disconnect(),r((e=>({events:{...e.events,connected:t}}))),Object.entries(null!=(n=o.handlers)?n:[]).forEach((([e,n])=>{const[r,o]=l[e];t.addEventListener(r,n,{passive:o})}))},disconnect:()=>{const{set:t,events:n}=e.getState();var r;n.connected&&(Object.entries(null!=(r=n.handlers)?r:[]).forEach((([e,t])=>{if(n&&n.connected instanceof HTMLElement){const[r]=l[e];n.connected.removeEventListener(r,t)}})),t((e=>({events:{...e.events,connected:void 0}}))))}}}const d=a.forwardRef((function({children:e,fallback:t,resize:n,style:l,gl:d,events:f=u,eventSource:p,eventPrefix:h,shadows:m,linear:v,flat:g,legacy:y,orthographic:b,frameloop:w,dpr:E,performance:S,raycaster:_,camera:P,onPointerMissed:x,onCreated:M,...C},j){a.useMemo((()=>(0,r.e)(i)),[]);const A=(0,c.y3)(),[O,R]=(0,s.A)({scroll:!0,debounce:{scroll:50,resize:0},...n}),k=a.useRef(null),z=a.useRef(null);a.useImperativeHandle(j,(()=>k.current));const T=(0,r.u)(x),[L,D]=a.useState(!1),[I,F]=a.useState(!1);if(L)throw L;if(I)throw I;const H=a.useRef(null);(0,r.a)((()=>{const t=k.current;R.width>0&&R.height>0&&t&&(H.current||(H.current=(0,r.b)(t)),H.current.configure({gl:d,events:f,shadows:m,linear:v,flat:g,legacy:y,orthographic:b,frameloop:w,dpr:E,performance:S,raycaster:_,camera:P,size:R,onPointerMissed:(...e)=>null==T.current?void 0:T.current(...e),onCreated:e=>{null==e.events.connect||e.events.connect(p?(0,r.i)(p)?p.current:p:z.current),h&&e.setEvents({compute:(e,t)=>{const n=e[h+"X"],r=e[h+"Y"];t.pointer.set(n/t.size.width*2-1,-r/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)}}),null==M||M(e)}}),H.current.render(a.createElement(A,null,a.createElement(r.E,{set:F},a.createElement(a.Suspense,{fallback:a.createElement(r.B,{set:D})},e)))))})),a.useEffect((()=>{const e=k.current;if(e)return()=>(0,r.d)(e)}),[]);const W=p?"none":"auto";return a.createElement("div",(0,o.A)({ref:z,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:W,...l}},C),a.createElement("div",{ref:O,style:{width:"100%",height:"100%"}},a.createElement("canvas",{ref:k,style:{display:"block"}},t)))})),f=a.forwardRef((function(e,t){return a.createElement(c.Af,null,a.createElement(d,(0,o.A)({},e,{ref:t})))}))}}]);