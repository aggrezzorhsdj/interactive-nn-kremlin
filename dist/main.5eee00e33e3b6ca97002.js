(()=>{"use strict";var e,a,t,r={464:(e,a,t)=>{var r=t(5338),s=t(6540),l=t(7859),i=t(4848);const n=()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("directionalLight",{castShadow:!0,"shadow-darkness":!0,"shadow-mapSize-height":2048,"shadow-mapSize-width":2048,"shadow-camera-near":.5,"shadow-camera-far":5e3,"shadow-camera-left":-5e3,"shadow-camera-right":5e3,"shadow-camera-bottom":-5e3,"shadow-camera-top":2e3,position:[1e3,500,600]}),(0,i.jsx)("directionalLight",{castShadow:!0,color:1118481,position:[-1,-1,-1]}),(0,i.jsx)("directionalLight",{castShadow:!0,color:16777215,position:[0,1,1]}),(0,i.jsx)("directionalLight",{castShadow:!0,color:2236962,position:[1,0,1]}),(0,i.jsx)("directionalLight",{castShadow:!0,color:2236962,position:[-1,0,1]}),(0,i.jsx)("ambientLight",{intensity:.4,color:12105900})]});var o=t(3865),c=t(2402),m=t(920),T=t(9174),g=t(9437);class d{static WOOD="./images/dver.jpg";static WOOD_GREEN="./images/zelderevo.jpg";static GLASS="./images/okno1.jpg";static PUTTY="./images/shpaklevka.jpg";static PUTTY_GREY="./images/sershpak.jpg";static PUTTY_DARK_GREY="./images/TSerShpak.jpg";static PUTTY_BEIGE="./images/bezhshpak.jpg";static ROOFING_FELT="./images/rubiroid.jpg";static METAL="./images/temnmetall.jpg";static SHEET="./images/proff1.jpg";static SHEET_GREEN="./images/zelproff.jpg";static BRICK_RED="./images/kirpich1.jpg";static BRICK_RED_BUMP="./images/kirpich.jpg";static PAINT_GREEN="./images/zelkraska.jpg";static ASPHALT="./images/asfalt1.jpg";static GRASS="./images/planee.jpg";static GOLD="./images/zoloto.jpg"}let u=function(e){return e.TERRAIN="terrain",e.ROAD="road",e.STAIRS="stairs",e.BASE="base",e.WALL="wall",e.TOWER="tower",e}({});const p=new Map([["terrain",u.TERRAIN],["stairs",u.STAIRS],["walls",u.WALL],["road1",u.ROAD],["road2",u.ROAD],["road3",u.ROAD],["road4",u.ROAD],["belaya",u.TOWER],["borisoglebovskaya",u.TOWER],["chasovaya",u.TOWER],["dmitrievskaya",u.TOWER],["georgievskaya",u.TOWER],["ivanovskaya",u.TOWER],["kladovaya",u.TOWER],["koromislova",u.TOWER],["nikolskaya",u.TOWER],["porohovaya",u.TOWER],["severnaya",u.TOWER],["tainitskaya",u.TOWER],["zachatskaya",u.TOWER]]),h=[-2e3,1e3,0,0,0,0],E=[{name:"arsenal",x:382,z:-730,url:"./models/arsenal.glb",textureUrls:[d.SHEET,d.BRICK_RED,d.PUTTY],angle:-1},{name:"hozkorpus",x:688,z:986,url:"./models/hozkorpus.glb",textureUrls:[d.ROOFING_FELT,d.BRICK_RED],angle:0},{name:"sovet",x:-119,z:-646,url:"./models/sovet.glb",textureUrls:[d.WOOD,d.GLASS,d.GLASS,d.PUTTY,d.GLASS,d.ROOFING_FELT,d.ROOFING_FELT,d.PUTTY,d.PUTTY_GREY,d.PUTTY_GREY,d.PUTTY],angle:0},{name:"garage",x:-336,z:-1380,url:"./models/garage.glb",textureUrls:[d.METAL,d.GLASS,d.PUTTY_GREY,d.PUTTY,d.ROOFING_FELT],angle:0},{name:"kazar",x:729,z:347,url:"./models/kazar.glb",textureUrls:[d.SHEET,d.BRICK_RED,d.BRICK_RED,d.BRICK_RED,d.BRICK_RED],depthY:-2},{name:"services",x:-139,z:-1240,url:"./models/services.glb",textureUrls:[d.PUTTY_GREY,d.PUTTY_GREY,d.SHEET_GREEN,d.WOOD,d.GLASS,d.PUTTY_BEIGE],angle:-1,depthY:0},{name:"vicegub",x:420,z:132,url:"./models/vicegub.glb",textureUrls:[d.PUTTY_GREY,d.PUTTY_GREY,d.SHEET_GREEN,d.PUTTY,d.PUTTY],depthY:0},{name:"hospital",x:420,z:-138,url:"./models/hospital.glb",textureUrls:[d.PUTTY_BEIGE,d.PUTTY,d.PUTTY,d.PUTTY,d.PUTTY,d.PUTTY,d.PUTTY_GREY,d.METAL,d.WOOD,d.WOOD,d.WOOD,d.ROOFING_FELT,d.GLASS,d.GLASS],depthY:0},{name:"kotel",x:-266,z:-1135,url:"./models/kotel.glb",textureUrls:[d.ROOFING_FELT,d.WOOD,d.WOOD,d.GLASS,d.PUTTY_GREY,d.PUTTY],depthY:0},{name:"muzei",x:-291,z:-974,url:"./models/muzei.glb",textureUrls:[d.WOOD,d.GLASS,d.SHEET,d.WOOD,d.METAL,d.METAL,d.PUTTY,d.PUTTY,d.PUTTY,d.PUTTY],depthY:-2},{name:"obkom",x:140,z:0,url:"./models/obkom.glb",textureUrls:[d.GLASS,d.WOOD,d.WOOD,d.GLASS,d.PUTTY,d.PUTTY],depthY:-2},{name:"minin",x:-355,z:131,url:"./models/minin.glb",textureUrls:[d.GLASS,d.PUTTY_DARK_GREY,d.PUTTY_DARK_GREY,d.PUTTY,d.PUTTY,d.PUTTY],depthY:-2},{name:"stella",x:687,z:-158,url:"./models/stella.glb",textureUrls:[d.PUTTY_GREY,d.PUTTY_DARK_GREY,d.PUTTY],depthY:-2},{name:"church",x:-78,z:360,url:"./models/church.glb",textureUrls:[d.METAL,d.WOOD_GREEN,d.PAINT_GREEN,d.PAINT_GREEN,d.PAINT_GREEN,d.PAINT_GREEN,d.PAINT_GREEN,d.PAINT_GREEN,d.PAINT_GREEN,d.PUTTY,d.GLASS,d.PUTTY,d.PUTTY,d.PUTTY,d.PUTTY,d.PUTTY],depthY:0},{name:"prisut",x:231,z:733,url:"./models/prisut.glb",textureUrls:["./images/zoloto.jpg",d.PUTTY,d.SHEET_GREEN,d.PUTTY,d.WOOD,d.PUTTY_GREY],depthY:-1},{name:"ministry",x:387,z:1182,url:"./models/ministry.glb",textureUrls:[d.PUTTY,d.PUTTY_BEIGE,d.PUTTY,d.ROOFING_FELT],depthY:-2},{name:"manezh",x:33,z:1251,url:"./models/manezh.glb",textureUrls:[d.PUTTY_GREY,d.SHEET_GREEN,d.BRICK_RED,d.GOLD,d.GOLD,d.SHEET_GREEN,d.PUTTY,d.BRICK_RED,d.BRICK_RED,d.PUTTY,d.PUTTY]},{name:"financial",x:33,z:1048,url:"./models/financial.glb",textureUrls:[d.PUTTY,d.PUTTY_BEIGE,d.PUTTY,d.PUTTY,d.ROOFING_FELT,d.ROOFING_FELT,d.PUTTY]}],x=[{name:"zachatskaya",title:"Зачатская башня",z:-366,x:-1070,url:"./models/zachatskaya.glb",textureUrls:["./images/kirpich1.jpg"],scale:.11,angle:-17},{name:"borisoglebovskaya",title:"Борисоглебовская башня",z:-1019,x:-875,url:"./models/borisoblebovskaya.glb",textureUrls:["./images/kirpich1.jpg"],scale:.13,angle:6},{name:"georgievskaya",title:"Георгиевская башня",z:-1606,x:-428,url:"./models/georgievskaya.glb",textureUrls:["./images/kirpich1.jpg"],scale:.11,angle:-90,depthY:-3},{name:"porohovaya",title:"Пороховая башня",z:-905,x:288,url:"./models/porohovaya.glb",textureUrls:["./images/kirpich1.jpg"],scale:.11},{name:"dmitrievskaya",z:-459,x:718,url:"./models/dmitrievskaya.glb",textureUrls:["./images/kirpich1.jpg"],scale:.11,angle:10,title:"Дмитриеская башня",text:"В память о великом князе Дмитрии Константиновиче и его покровителе Дмитрии Солунском центральную башню Нижегородского кремля назвали Дмитриевской. Опорный пункт защиты Верхнего Посада. Прямоугольная, проезжая башня соединялась каменным арочным мостом с предмостным укреплением — пятиугольной отводной стрельницей в окружении крепостного рва.",image:"./images/dmit-bashnya-min.png"},{name:"kladovaya",title:"Кладовая башня",z:157,x:900,url:"./models/kladovaya.glb",textureUrls:["./images/kirpich1.jpg"],scale:.11,angle:0},{name:"nikolskaya",title:"Никольская башня",z:784,x:1072,url:"./models/nikolskaya.glb",textureUrls:["./images/kirpich1.jpg"],scale:.11,angle:10},{name:"koromislova",title:"Коромыслова башня",z:1340,x:900,url:"./models/koromislova.glb",textureUrls:["./images/kirpich1.jpg"],scale:.11,angle:10},{name:"tainitskaya",title:"Тайнитская башня",z:1568,x:7,url:"./models/tainitskaya.glb",textureUrls:["./images/kirpich1.jpg"],scale:.11,angle:10},{name:"severnaya",title:"Северная башня",z:1247,x:-486,url:"./models/severnaya.glb",textureUrls:["./images/kirpich1.jpg"],scale:.11,angle:0},{name:"chasovaya",title:"Часовая башня",z:1043,x:-459,url:"./models/chasovaya.glb",textureUrls:["./images/kirpich1.jpg"],scale:.11,angle:0,depthY:-3},{name:"ivanovskaya",title:"Ивановская башня",z:720,x:-883,url:"./models/ivanovskaya.glb",textureUrls:["./images/kirpich1.jpg"],scale:.11,angle:12,depthY:-1},{name:"belaya",title:"Белая башня",z:149,x:-1037,url:"./models/belaya.glb",textureUrls:["./images/kirpich1.jpg"],scale:.11,angle:12,depthY:-5}];var R=t(9689);function U(e,a,t){const r=t.children.find((e=>e.name===u.BASE))?.children.find((e=>e.name===u.TERRAIN)),s=new g.Raycaster,l=new g.Vector3(e,0,a),i=[new g.Vector3(0,90*g.MathUtils.DEG2RAD,0),new g.Vector3(0,-90*g.MathUtils.DEG2RAD,0)];let n;r.updateMatrixWorld();for(const e of i){s.set(l,e);const a=s.intersectObject(r);if(a?.length&&a[0].point){n=a[0];break}}return n?.point}var O=t(9644);function P(e){const a=(0,T.z)(e);return a.wrapS=g.MirroredRepeatWrapping,a.wrapT=g.MirroredRepeatWrapping,a.repeat.set(20,20),a.anisotropy=12,a}var b=t(2656);const Y=e=>{let{building:a,onClick:t}=e;const{x:r,z:l,url:n,name:o,textureUrls:c,angle:T,scale:d}=a,{scene:u}=(0,R.z)(),[p,h]=(0,s.useState)(null),E=(0,m.p)(n,!0),x=(0,s.useRef)(null);let Y;const _=Object.values(E.nodes).filter((e=>e instanceof g.Mesh)),S=new g.Group;S.add(..._),S.name=o,Y=S;const[j,v]=(0,s.useState)(!1);return(0,s.useEffect)((()=>{const e=function(e,a,t){const r=(new g.Box3).setFromObject(t),s=new g.Vector3,l=new g.Vector3;r.getCenter(s),r.getSize(l);const i=l.x/2,n=l.z/2,o=[new g.Vector3(e.x-i,e.y,e.z-n),new g.Vector3(e.x+i,e.y,e.z+n),new g.Vector3(e.x-i,e.y,e.z+n),new g.Vector3(e.x+i,e.y,e.z-n)].map((e=>(U(e.x,e.z,a)||new g.Vector3(0,0,0)).y));return new g.Vector3(e.x,Math.min(...o),e.z)}(U(r,l,u)||new g.Vector3(0,0,0),u,x.current);h(e)}),[u]),(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("group",{name:o,ref:x,position:new g.Vector3(r,p?.y||0,l),"rotation-y":g.MathUtils.DEG2RAD*(T??0),scale:d??1,onClick:e=>t&&t(e,a),onPointerLeave:()=>{v(!1)},onPointerEnter:()=>{v(!0)},children:[Y?.children?.map(((e,a)=>{const t=P(c[a]);return(0,i.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:e.geometry,material:new g.MeshPhongMaterial({map:t,side:g.DoubleSide})},e.id)})),j&&(0,i.jsx)(O.E,{children:(0,i.jsx)(b.A,{title:a.title||a.name,open:!0})})]})})},_=(0,s.memo)(Y),S=(0,t(1511).v)((e=>({selectedBuilding:null,cameraParameters:h,setSelectedBuilding:a=>e((()=>({selectedBuilding:a}))),setCameraParameters:a=>e((()=>({cameraParameters:a})))}))),j=()=>{const e=S((e=>e)),a=(a,t)=>{p.get(t.name)===u.TOWER&&(e.setCameraParameters([a.point.x-300,50,a.point.z-100,a.point.x,a.point.y,a.point.z]),e.setSelectedBuilding(t))};return(0,i.jsxs)(i.Fragment,{children:[E.map((e=>(0,i.jsx)(_,{building:e},e.name))),x.map((e=>(0,i.jsx)(_,{building:e,onClick:a},e.name)))]})},v=(0,s.memo)(j),k=()=>{const e=(0,m.p)("./models/base.glb",!0);return e.scene.name="base",e.scene.children.forEach((e=>{if(e.isMesh){let a=(0,T.z)(d.BRICK_RED);switch(p.get(e.name)){case u.TERRAIN:a=P(d.GRASS),e.material=new g.MeshPhongMaterial({map:a,shininess:0,side:g.DoubleSide});break;case u.WALL:case u.TOWER:const t=P(d.BRICK_RED_BUMP);e.material=new g.MeshPhongMaterial({map:a,bumpMap:t,shininess:1,bumpScale:12,side:g.DoubleSide});break;case u.STAIRS:case u.ROAD:a=P(d.ASPHALT),e.material=new g.MeshStandardMaterial({map:a,side:g.DoubleSide})}e.receiveShadow=!0,e.castShadow=!0,a.needsUpdate=!0}})),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("primitive",{object:e.scene}),(0,i.jsx)(v,{})]})},f=(0,s.memo)(k);var y=t(8262),G=t(1653);const A=()=>{const{setSelectedBuilding:e,selectedBuilding:a,setCameraParameters:t}=S(),r=()=>{e(null),t(h)};return(0,i.jsx)(y.A,{title:a?.title||a?.name,open:!!a,onClose:r,onOk:r,onCancel:r,width:500,footer:(0,i.jsx)(G.Ay,{onClick:r,children:"Закрыть"}),children:(0,i.jsxs)("div",{className:"modal__body",children:[a?.image&&(0,i.jsx)("div",{className:"modal__image",children:(0,i.jsx)("img",{src:a.image,alt:a.name})}),a?.text&&(0,i.jsx)("div",{className:"modal__text",children:a.text})]})})},z=(0,s.memo)(A),w=()=>{const e=(0,s.useRef)(),{cameraParameters:a}=S();return(0,s.useEffect)((()=>{e?.current&&e.current.setLookAt(...a,!0).then()}),[a]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(l.Hl,{shadows:"soft",camera:{fov:60,aspect:window.innerWidth/window.innerHeight,near:1,far:1e5,position:new g.Vector3(...h.slice(0,2))},children:[(0,i.jsx)(s.Suspense,{fallback:null,children:(0,i.jsx)(f,{})}),(0,i.jsx)(n,{}),(0,i.jsx)(o.a,{ref:e,minPolarAngle:Math.PI/2.7,maxPolarAngle:Math.PI/2.15})]}),(0,i.jsx)(c.a,{}),(0,i.jsx)(z,{})]})};(0,r.H)(document.getElementById("root")).render((0,i.jsx)(w,{}))}},s={};function l(e){var a=s[e];if(void 0!==a)return a.exports;var t=s[e]={exports:{}};return r[e](t,t.exports,l),t.exports}l.m=r,e=[],l.O=(a,t,r,s)=>{if(!t){var i=1/0;for(m=0;m<e.length;m++){t=e[m][0],r=e[m][1],s=e[m][2];for(var n=!0,o=0;o<t.length;o++)(!1&s||i>=s)&&Object.keys(l.O).every((e=>l.O[e](t[o])))?t.splice(o--,1):(n=!1,s<i&&(i=s));if(n){e.splice(m--,1);var c=r();void 0!==c&&(a=c)}}return a}s=s||0;for(var m=e.length;m>0&&e[m-1][2]>s;m--)e[m]=e[m-1];e[m]=[t,r,s]},l.n=e=>{var a=e&&e.__esModule?()=>e.default:()=>e;return l.d(a,{a}),a},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,l.t=function(e,r){if(1&r&&(e=this(e)),8&r)return e;if("object"==typeof e&&e){if(4&r&&e.__esModule)return e;if(16&r&&"function"==typeof e.then)return e}var s=Object.create(null);l.r(s);var i={};a=a||[null,t({}),t([]),t(t)];for(var n=2&r&&e;"object"==typeof n&&!~a.indexOf(n);n=t(n))Object.getOwnPropertyNames(n).forEach((a=>i[a]=()=>e[a]));return i.default=()=>e,l.d(s,i),s},l.d=(e,a)=>{for(var t in a)l.o(a,t)&&!l.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:a[t]})},l.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),l.o=(e,a)=>Object.prototype.hasOwnProperty.call(e,a),l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={792:0};l.O.j=a=>0===e[a];var a=(a,t)=>{var r,s,i=t[0],n=t[1],o=t[2],c=0;if(i.some((a=>0!==e[a]))){for(r in n)l.o(n,r)&&(l.m[r]=n[r]);if(o)var m=o(l)}for(a&&a(t);c<i.length;c++)s=i[c],l.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return l.O(m)},t=self.webpackChunkinteractive_nn_kremlin=self.webpackChunkinteractive_nn_kremlin||[];t.forEach(a.bind(null,0)),t.push=a.bind(null,t.push.bind(t))})();var i=l.O(void 0,[874,641,632,8,931,582,587,543,233,169,499],(()=>l(464)));i=l.O(i)})();