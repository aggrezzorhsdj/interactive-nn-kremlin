(()=>{"use strict";var e,a,t,r={1274:(e,a,t)=>{var r=t(5338),s=t(6540),l=t(7859),n=t(3865),o=t(2402);class i{static WOOD="./images/dver.jpg";static WOOD_GREEN="./images/zelderevo.jpg";static GLASS="./images/okno1.jpg";static PUTTY="./images/shpaklevka.jpg";static PUTTY_GREY="./images/sershpak.jpg";static PUTTY_DARK_GREY="./images/TSerShpak.jpg";static PUTTY_BEIGE="./images/bezhshpak.jpg";static ROOFING_FELT="./images/rubiroid.jpg";static METAL="./images/temnmetall.jpg";static SHEET="./images/proff1.jpg";static SHEET_GREEN="./images/zelproff.jpg";static BRICK_RED="./images/kirpich1.jpg";static BRICK_RED_BUMP="./images/kirpich.jpg";static PAINT_GREEN="./images/zelkraska.jpg";static ASPHALT="./images/asfalt1.jpg";static GRASS="./images/planee.jpg";static GOLD="./images/zoloto.jpg"}const c=[{name:"arsenal",x:382,z:-730,url:"./models/arsenal.glb",textureUrls:[i.SHEET,i.BRICK_RED,i.PUTTY],angle:-1},{name:"hozkorpus",x:688,z:986,url:"./models/hozkorpus.glb",textureUrls:[i.ROOFING_FELT,i.BRICK_RED],angle:0},{name:"sovet",x:-119,z:-646,url:"./models/sovet.glb",textureUrls:[i.WOOD,i.GLASS,i.GLASS,i.PUTTY,i.GLASS,i.ROOFING_FELT,i.ROOFING_FELT,i.PUTTY,i.PUTTY_GREY,i.PUTTY_GREY,i.PUTTY],angle:0},{name:"garage",x:-336,z:-1380,url:"./models/garage.glb",textureUrls:[i.METAL,i.GLASS,i.PUTTY_GREY,i.PUTTY,i.ROOFING_FELT],angle:0},{name:"kazar",x:729,z:347,url:"./models/kazar.glb",textureUrls:[i.SHEET,i.BRICK_RED,i.BRICK_RED,i.BRICK_RED,i.BRICK_RED],depthY:-2},{name:"services",x:-139,z:-1240,url:"./models/services.glb",textureUrls:[i.PUTTY_GREY,i.PUTTY_GREY,i.SHEET_GREEN,i.WOOD,i.GLASS,i.PUTTY_BEIGE],angle:-1,depthY:0},{name:"vicegub",x:420,z:132,url:"./models/vicegub.glb",textureUrls:[i.PUTTY_GREY,i.PUTTY_GREY,i.SHEET_GREEN,i.PUTTY,i.PUTTY],depthY:0},{name:"hospital",x:420,z:-138,url:"./models/hospital.glb",textureUrls:[i.PUTTY_BEIGE,i.PUTTY,i.PUTTY,i.PUTTY,i.PUTTY,i.PUTTY,i.PUTTY_GREY,i.METAL,i.WOOD,i.WOOD,i.WOOD,i.ROOFING_FELT,i.GLASS,i.GLASS],depthY:0},{name:"kotel",x:-266,z:-1135,url:"./models/kotel.glb",textureUrls:[i.ROOFING_FELT,i.WOOD,i.WOOD,i.GLASS,i.PUTTY_GREY,i.PUTTY],depthY:0},{name:"muzei",x:-291,z:-974,url:"./models/muzei.glb",textureUrls:[i.WOOD,i.GLASS,i.SHEET,i.WOOD,i.METAL,i.METAL,i.PUTTY,i.PUTTY,i.PUTTY,i.PUTTY],depthY:-2},{name:"obkom",x:140,z:0,url:"./models/obkom.glb",textureUrls:[i.GLASS,i.WOOD,i.WOOD,i.GLASS,i.PUTTY,i.PUTTY],depthY:-2},{name:"minin",x:-355,z:131,url:"./models/minin.glb",textureUrls:[i.GLASS,i.PUTTY_DARK_GREY,i.PUTTY_DARK_GREY,i.PUTTY,i.PUTTY,i.PUTTY],depthY:-2},{name:"stella",x:687,z:-158,url:"./models/stella.glb",textureUrls:[i.PUTTY_GREY,i.PUTTY_DARK_GREY,i.PUTTY],depthY:-2},{name:"church",x:-78,z:360,url:"./models/church.glb",textureUrls:[i.METAL,i.WOOD_GREEN,i.PAINT_GREEN,i.PAINT_GREEN,i.PAINT_GREEN,i.PAINT_GREEN,i.PAINT_GREEN,i.PAINT_GREEN,i.PAINT_GREEN,i.PUTTY,i.GLASS,i.PUTTY,i.PUTTY,i.PUTTY,i.PUTTY,i.PUTTY],depthY:0},{name:"prisut",x:231,z:733,url:"./models/prisut.glb",textureUrls:["./images/zoloto.jpg",i.PUTTY,i.SHEET_GREEN,i.PUTTY,i.WOOD,i.PUTTY_GREY],depthY:-1},{name:"ministry",x:387,z:1182,url:"./models/ministry.glb",textureUrls:[i.PUTTY,i.PUTTY_BEIGE,i.PUTTY,i.ROOFING_FELT],depthY:-2},{name:"manezh",x:33,z:1251,url:"./models/manezh.glb",textureUrls:[i.PUTTY_GREY,i.SHEET_GREEN,i.BRICK_RED,i.GOLD,i.GOLD,i.SHEET_GREEN,i.PUTTY,i.BRICK_RED,i.BRICK_RED,i.PUTTY,i.PUTTY]},{name:"financial",x:33,z:1048,url:"./models/financial.glb",textureUrls:[i.PUTTY,i.PUTTY_BEIGE,i.PUTTY,i.PUTTY,i.ROOFING_FELT,i.ROOFING_FELT,i.PUTTY]}],m=[{name:"zachatskaya",title:"Зачатская башня",z:-366,x:-1070,url:"./models/zachatskaya.glb",textureUrls:[i.BRICK_RED],scale:.11,angle:-17},{name:"borisoglebovskaya",title:"Борисоглебовская башня",z:-1019,x:-875,url:"./models/borisoblebovskaya.glb",textureUrls:[i.BRICK_RED],scale:.13,angle:6},{name:"georgievskaya",title:"Георгиевская башня",z:-1606,x:-428,url:"./models/georgievskaya.glb",textureUrls:[i.BRICK_RED],scale:.11,angle:-90,depthY:-3},{name:"porohovaya",title:"Пороховая башня",z:-905,x:288,url:"./models/porohovaya.glb",textureUrls:[i.BRICK_RED],scale:.11},{name:"dmitrievskaya",z:-459,x:718,url:"./models/dmitrievskaya.glb",textureUrls:[i.BRICK_RED],scale:.11,angle:10,title:"Дмитриеская башня",text:"В память о великом князе Дмитрии Константиновиче и его покровителе Дмитрии Солунском центральную башню Нижегородского кремля назвали Дмитриевской. Опорный пункт защиты Верхнего Посада. Прямоугольная, проезжая башня соединялась каменным арочным мостом с предмостным укреплением — пятиугольной отводной стрельницей в окружении крепостного рва.",image:"./images/dmit-bashnya-min.png"},{name:"kladovaya",title:"Кладовая башня",z:157,x:900,url:"./models/kladovaya.glb",textureUrls:[i.BRICK_RED],scale:.11,angle:0},{name:"nikolskaya",title:"Никольская башня",z:784,x:1072,url:"./models/nikolskaya.glb",textureUrls:[i.BRICK_RED],scale:.11,angle:10},{name:"koromislova",title:"Коромыслова башня",z:1340,x:900,url:"./models/koromislova.glb",textureUrls:[i.BRICK_RED],scale:.11,angle:10},{name:"tainitskaya",title:"Тайнитская башня",z:1568,x:7,url:"./models/tainitskaya.glb",textureUrls:[i.BRICK_RED],scale:.11,angle:10},{name:"severnaya",title:"Северная башня",z:1247,x:-486,url:"./models/severnaya.glb",textureUrls:[i.BRICK_RED],scale:.11,angle:0},{name:"chasovaya",title:"Часовая башня",z:1043,x:-459,url:"./models/chasovaya.glb",textureUrls:[i.BRICK_RED],scale:.11,angle:0,depthY:-3},{name:"ivanovskaya",title:"Ивановская башня",z:720,x:-883,url:"./models/ivanovskaya.glb",textureUrls:[i.BRICK_RED],scale:.11,angle:12,depthY:-1},{name:"belaya",title:"Белая башня",z:149,x:-1037,url:"./models/belaya.glb",textureUrls:[i.BRICK_RED],scale:.11,angle:12,depthY:-5}];let T=function(e){return e.TERRAIN="terrain",e.ROAD="road",e.STAIRS="stairs",e.BASE="base",e.WALL="wall",e.TOWER="tower",e}({});const d=new Map([["terrain",T.TERRAIN],["stairs",T.STAIRS],["walls",T.WALL],["road1",T.ROAD],["road2",T.ROAD],["road3",T.ROAD],["road4",T.ROAD],["belaya",T.TOWER],["borisoglebovskaya",T.TOWER],["chasovaya",T.TOWER],["dmitrievskaya",T.TOWER],["georgievskaya",T.TOWER],["ivanovskaya",T.TOWER],["kladovaya",T.TOWER],["koromislova",T.TOWER],["nikolskaya",T.TOWER],["porohovaya",T.TOWER],["severnaya",T.TOWER],["tainitskaya",T.TOWER],["zachatskaya",T.TOWER]]),g=[-2e3,1e3,0,0,0,0];var u=t(9689),E=t(9437);function R(e,a,t){const r=t.children.find((e=>e.name===T.BASE))?.children.find((e=>e.name===T.TERRAIN)),s=new E.Raycaster,l=new E.Vector3(e,0,a),n=[new E.Vector3(0,90*E.MathUtils.DEG2RAD,0),new E.Vector3(0,-90*E.MathUtils.DEG2RAD,0)];let o;r.updateMatrixWorld();for(const e of n){s.set(l,e);const a=s.intersectObject(r);if(a?.length&&a[0].point){o=a[0];break}}return o?.point}var h=t(920),p=t(9644),x=t(9174);function U(e){const a=(0,x.z)(e);return a.wrapS=E.MirroredRepeatWrapping,a.wrapT=E.MirroredRepeatWrapping,a.repeat.set(20,20),a.anisotropy=12,a}var O=t(2656),_=t(4848);const P=e=>{let{building:a,onClick:t}=e;const{x:r,z:l,url:n,name:o,textureUrls:i,angle:c,scale:m}=a,{scene:T}=(0,u.z)(),[d,g]=(0,s.useState)(null),x=(0,h.p)(n,!0),P=(0,s.useRef)(null);let b;const Y=Object.values(x.nodes).filter((e=>e instanceof E.Mesh)),S=new E.Group;S.add(...Y),S.name=o,b=S;const[v,f]=(0,s.useState)(!1);return(0,s.useEffect)((()=>{const e=function(e,a,t){const r=(new E.Box3).setFromObject(t),s=new E.Vector3,l=new E.Vector3;r.getCenter(s),r.getSize(l);const n=l.x/2,o=l.z/2,i=[new E.Vector3(e.x-n,e.y,e.z-o),new E.Vector3(e.x+n,e.y,e.z+o),new E.Vector3(e.x-n,e.y,e.z+o),new E.Vector3(e.x+n,e.y,e.z-o)].map((e=>(R(e.x,e.z,a)||new E.Vector3(0,0,0)).y));return new E.Vector3(e.x,Math.min(...i),e.z)}(R(r,l,T)||new E.Vector3(0,0,0),T,P.current);g(e)}),[T]),(0,_.jsx)(_.Fragment,{children:(0,_.jsxs)("group",{name:o,ref:P,position:new E.Vector3(r,d?.y||0,l),"rotation-y":E.MathUtils.DEG2RAD*(c??0),scale:m??1,onClick:e=>t&&t(e,a),onPointerLeave:()=>{f(!1)},onPointerEnter:()=>{f(!0)},children:[b?.children?.map(((e,a)=>{const t=U(i[a]);return(0,_.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:e.geometry,material:new E.MeshPhongMaterial({map:t,side:E.DoubleSide})},e.id)})),v&&(0,_.jsx)(p.E,{children:(0,_.jsx)(O.A,{title:a.title||a.name,open:!0})})]})})},b=(0,s.memo)(P),Y=(0,t(1511).v)((e=>({selectedBuilding:null,cameraParameters:g,setSelectedBuilding:a=>e((()=>({selectedBuilding:a}))),setCameraParameters:a=>e((()=>({cameraParameters:a})))}))),S=()=>{const e=Y((e=>e)),a=(a,t)=>{d.get(t.name)===T.TOWER&&(e.setCameraParameters([a.point.x-300,50,a.point.z-100,a.point.x,a.point.y,a.point.z]),e.setSelectedBuilding(t))};return(0,_.jsxs)(_.Fragment,{children:[c.map((e=>(0,_.jsx)(b,{building:e},e.name))),m.map((e=>(0,_.jsx)(b,{building:e,onClick:a},e.name)))]})},v=(0,s.memo)(S),f=()=>(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("directionalLight",{castShadow:!0,"shadow-darkness":!0,"shadow-mapSize-height":2048,"shadow-mapSize-width":2048,"shadow-camera-near":.5,"shadow-camera-far":5e3,"shadow-camera-left":-5e3,"shadow-camera-right":5e3,"shadow-camera-bottom":-5e3,"shadow-camera-top":2e3,position:[1e3,500,600]}),(0,_.jsx)("directionalLight",{castShadow:!0,color:1118481,position:[-1,-1,-1]}),(0,_.jsx)("directionalLight",{castShadow:!0,color:16777215,position:[0,1,1]}),(0,_.jsx)("directionalLight",{castShadow:!0,color:2236962,position:[1,0,1]}),(0,_.jsx)("directionalLight",{castShadow:!0,color:2236962,position:[-1,0,1]}),(0,_.jsx)("ambientLight",{intensity:.4,color:12105900})]}),y=(0,s.memo)(f),G=()=>{const e=(0,h.p)("./models/base.glb",!0);return e.scene.name="base",e.scene.children.forEach((e=>{if(e.isMesh){let a=(0,x.z)(i.BRICK_RED);switch(d.get(e.name)){case T.TERRAIN:a=U(i.GRASS),e.material=new E.MeshPhongMaterial({map:a,shininess:0,side:E.DoubleSide});break;case T.WALL:case T.TOWER:const t=U(i.BRICK_RED_BUMP);e.material=new E.MeshPhongMaterial({map:a,bumpMap:t,shininess:1,bumpScale:12,side:E.DoubleSide});break;case T.STAIRS:case T.ROAD:a=U(i.ASPHALT),e.material=new E.MeshStandardMaterial({map:a,side:E.DoubleSide})}e.receiveShadow=!0,e.castShadow=!0,a.needsUpdate=!0}})),(0,_.jsx)("primitive",{object:e.scene})},j=(0,s.memo)(G),k=()=>(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(j,{}),(0,_.jsx)(v,{}),(0,_.jsx)(y,{})]}),A=(0,s.memo)(k);var z=t(8262),D=t(1653);const w=()=>{const{setSelectedBuilding:e,selectedBuilding:a,setCameraParameters:t}=Y(),r=()=>{e(null),t(g)};return(0,_.jsx)(z.A,{title:a?.title||a?.name,open:!!a,onClose:r,onOk:r,onCancel:r,width:500,footer:(0,_.jsx)(D.Ay,{onClick:r,children:"Закрыть"}),children:(0,_.jsxs)("div",{className:"modal__body",children:[a?.image&&(0,_.jsx)("div",{className:"modal__image",children:(0,_.jsx)("img",{src:a.image,alt:a.name})}),a?.text&&(0,_.jsx)("div",{className:"modal__text",children:a.text})]})})},I=(0,s.memo)(w),L=()=>{const e=(0,s.useRef)(),{cameraParameters:a}=Y();return(0,s.useEffect)((()=>{e?.current&&e.current.setLookAt(...a,!0).then()}),[a]),(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)(l.Hl,{shadows:"soft",camera:{fov:60,aspect:window.innerWidth/window.innerHeight,near:1,far:1e5,position:new E.Vector3(...g.slice(0,2))},children:[(0,_.jsx)(s.Suspense,{fallback:null,children:(0,_.jsx)(A,{})}),(0,_.jsx)(n.a,{ref:e,minPolarAngle:Math.PI/2.7,maxPolarAngle:Math.PI/2.15})]}),(0,_.jsx)(o.a,{}),(0,_.jsx)(I,{})]})};(0,r.H)(document.getElementById("root")).render((0,_.jsx)(L,{}))}},s={};function l(e){var a=s[e];if(void 0!==a)return a.exports;var t=s[e]={exports:{}};return r[e](t,t.exports,l),t.exports}l.m=r,e=[],l.O=(a,t,r,s)=>{if(!t){var n=1/0;for(m=0;m<e.length;m++){t=e[m][0],r=e[m][1],s=e[m][2];for(var o=!0,i=0;i<t.length;i++)(!1&s||n>=s)&&Object.keys(l.O).every((e=>l.O[e](t[i])))?t.splice(i--,1):(o=!1,s<n&&(n=s));if(o){e.splice(m--,1);var c=r();void 0!==c&&(a=c)}}return a}s=s||0;for(var m=e.length;m>0&&e[m-1][2]>s;m--)e[m]=e[m-1];e[m]=[t,r,s]},l.n=e=>{var a=e&&e.__esModule?()=>e.default:()=>e;return l.d(a,{a}),a},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,l.t=function(e,r){if(1&r&&(e=this(e)),8&r)return e;if("object"==typeof e&&e){if(4&r&&e.__esModule)return e;if(16&r&&"function"==typeof e.then)return e}var s=Object.create(null);l.r(s);var n={};a=a||[null,t({}),t([]),t(t)];for(var o=2&r&&e;"object"==typeof o&&!~a.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach((a=>n[a]=()=>e[a]));return n.default=()=>e,l.d(s,n),s},l.d=(e,a)=>{for(var t in a)l.o(a,t)&&!l.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:a[t]})},l.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),l.o=(e,a)=>Object.prototype.hasOwnProperty.call(e,a),l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={792:0};l.O.j=a=>0===e[a];var a=(a,t)=>{var r,s,n=t[0],o=t[1],i=t[2],c=0;if(n.some((a=>0!==e[a]))){for(r in o)l.o(o,r)&&(l.m[r]=o[r]);if(i)var m=i(l)}for(a&&a(t);c<n.length;c++)s=n[c],l.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return l.O(m)},t=self.webpackChunkinteractive_nn_kremlin=self.webpackChunkinteractive_nn_kremlin||[];t.forEach(a.bind(null,0)),t.push=a.bind(null,t.push.bind(t))})();var n=l.O(void 0,[874,641,632,8,931,582,587,543,233,169,499],(()=>l(1274)));n=l.O(n)})();